import pandas as pd
import sys
import os

def main():
    if len(sys.argv) < 2:
        print("‚ö†Ô∏è Usage: python3 convert.py <excel_file.xlsx>")
        return

    excel_file = sys.argv[1]

    if not os.path.exists(excel_file):
        print(f"‚ùå File not found: {excel_file}")
        return

    print(f"‚úÖ Found Excel file: {excel_file}")

    try:
        # Load all sheets into a dict {sheet_name: DataFrame}
        sheets = pd.read_excel(excel_file, sheet_name=None)
    except Exception as e:
        print(f"‚ùå Error reading {excel_file}: {e}")
        return

    base_name = os.path.splitext(excel_file)[0]

    for sheet_name, df in sheets.items():
        # Clean up sheet name for filename
        safe_name = sheet_name.replace(" ", "_").replace("/", "_")
        json_file = f"{base_name}_{safe_name}.json"

        try:
            df.to_json(json_file, orient="records", indent=4)
            print(f"üéâ Exported sheet '{sheet_name}' ‚Üí {json_file}")
        except Exception as e:
            print(f"‚ùå Error converting sheet '{sheet_name}': {e}")

if __name__ == "__main__":
    main()
